# Custom cross image for x86_64-unknown-linux-musl with protoc for proto compilation.
# Cross provides CROSS_BASE_IMAGE; we extend it and install protobuf compiler.
ARG CROSS_BASE_IMAGE
FROM $CROSS_BASE_IMAGE
# Install protoc: Alpine uses apk, Debian/Ubuntu uses apt-get
RUN if command -v apk >/dev/null 2>&1; then \
      apk add --no-cache protobuf; \
    else \
      apt-get update && apt-get install -y --no-install-recommends protobuf-compiler && rm -rf /var/lib/apt/lists/*; \
    fi
