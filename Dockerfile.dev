# Development Dockerfile for Vectorizer
FROM rust:1.75-slim

# Install system dependencies for development
RUN apt-get update && apt-get install -y \
    pkg-config \
    libssl-dev \
    ca-certificates \
    curl \
    git \
    vim \
    htop \
    && rm -rf /var/lib/apt/lists/*

# Install additional Rust tools
RUN cargo install cargo-watch cargo-outdated cargo-audit

# Set working directory
WORKDIR /app

# Copy manifest files
COPY Cargo.toml Cargo.lock ./

# Copy source code
COPY src/ src/
COPY examples/ examples/
COPY docs/ docs/
COPY benches/ benches/
COPY tests/ tests/
COPY config.example.yml ./
COPY audit.toml ./

# Create development user
RUN useradd -m -s /bin/bash dev && \
    usermod -aG sudo dev && \
    echo "dev ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers

# Switch to development user
USER dev

# Expose ports for development
EXPOSE 15001 15002 15003

# Default command for development
CMD ["bash"]
